/**
 * van11y-accessible-accordion-aria - ES2015 accessible accordion system, using ARIA (compatible IE9+ when transpiled)
 * @version v1.0.5
 * @link https://van11y.net/accessible-accordion/
 * @license MIT : https://github.com/nico3333fr/van11y-accessible-accordion-aria/blob/master/LICENSE
 */
"use strict";function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(exports,"__esModule",{value:!0});var ACCORDION_JS="js-accordion",ACCORDION_JS_HEADER="js-accordion__header",ACCORDION_JS_PANEL="js-accordion__panel",ACCORDION_DATA_PREFIX_CLASS="data-accordion-prefix-classes",ACCORDION_DATA_OPENED="data-accordion-opened",ACCORDION_DATA_MULTISELECTABLE="data-accordion-multiselectable",ACCORDION_PREFIX_IDS="accordion",ACCORDION_BUTTON_ID="_tab",ACCORDION_PANEL_ID="_panel",ACCORDION_STYLE="accordion",ACCORDION_TITLE_STYLE="accordion__title",ACCORDION_HEADER_STYLE="accordion__header",ACCORDION_PANEL_STYLE="accordion__panel",ACCORDION_ROLE_TABLIST="tablist",ACCORDION_ROLE_TAB="tab",ACCORDION_ROLE_TABPANEL="tabpanel",ATTR_ROLE="role",ATTR_MULTISELECTABLE="aria-multiselectable",ATTR_EXPANDED="aria-expanded",ATTR_LABELLEDBY="aria-labelledby",ATTR_HIDDEN="aria-hidden",ATTR_CONTROLS="aria-controls",ATTR_SELECTED="aria-selected",IS_OPENED_CLASS="is-open";Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),r=t.length;--r>=0&&t.item(r)!==this;);return r>-1});var findById=function(e){return document.getElementById(e)},addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},removeClass=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},hasClass=function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},setAttributes=function(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})},unSelectHeaders=function(e){e.forEach(function(e){var t;setAttributes(e,(t={},_defineProperty(t,ATTR_SELECTED,"false"),_defineProperty(t,"tabindex","-1"),t))})},selectHeader=function(e){e.setAttribute(ATTR_SELECTED,!0),e.removeAttribute("tabindex")},selectHeaderInList=function(e,t){var r=void 0;e.forEach(function(e,t){"true"===e.getAttribute(ATTR_SELECTED)&&(r=t)}),"next"===t&&(selectHeader(e[r+1]),setTimeout(function(){e[r+1].focus()},0)),"prev"===t&&(selectHeader(e[r-1]),setTimeout(function(){e[r-1].focus()},0))},searchParent=function(e,t){for(var r=!1,n=e.parentNode;n&&r===!1;)hasClass(n,t)===!0?r=!0:n=n.parentNode;return r===!0?n.getAttribute("id"):""},findAncestor=function(e,t){if("function"==typeof e.closest)return e.closest(t)||null;for(;e;){if(e.matches(t))return e;e=e.parentElement}return null},$listAccordions=function(){return[].slice.call(document.querySelectorAll("."+ACCORDION_JS))},init=function(){$listAccordions().forEach(function(e,t){var r=t+1,n=e.hasAttribute(ACCORDION_DATA_PREFIX_CLASS)===!0?e.getAttribute(ACCORDION_DATA_PREFIX_CLASS)+"-":"";"none"===e.getAttribute(ACCORDION_DATA_MULTISELECTABLE)?e.setAttribute(ATTR_MULTISELECTABLE,"false"):e.setAttribute(ATTR_MULTISELECTABLE,"true"),e.setAttribute(ATTR_ROLE,ACCORDION_ROLE_TABLIST),addClass(e,n+ACCORDION_STYLE);var s=[].slice.call(e.querySelectorAll("."+ACCORDION_JS_HEADER));s.forEach(function(e,t){var s,A,a=t+1,o=e.nextElementSibling,i=e.innerHTML,c=document.createElement("BUTTON"),l=e.hasAttribute(ACCORDION_DATA_OPENED)===!0?e.getAttribute(ACCORDION_DATA_OPENED):"";c.innerHTML=i,addClass(c,ACCORDION_JS_HEADER),addClass(c,n+ACCORDION_HEADER_STYLE),setAttributes(c,(s={},_defineProperty(s,ATTR_ROLE,ACCORDION_ROLE_TAB),_defineProperty(s,"id",ACCORDION_PREFIX_IDS+r+ACCORDION_BUTTON_ID+a),_defineProperty(s,ATTR_CONTROLS,ACCORDION_PREFIX_IDS+r+ACCORDION_PANEL_ID+a),_defineProperty(s,ATTR_SELECTED,"false"),_defineProperty(s,"tabindex","-1"),_defineProperty(s,"type","button"),s)),c=e.parentElement.insertBefore(c,e),o.insertBefore(e,o.firstChild),addClass(e,n+ACCORDION_TITLE_STYLE),removeClass(e,ACCORDION_JS_HEADER),addClass(o,n+ACCORDION_PANEL_STYLE),setAttributes(o,(A={},_defineProperty(A,ATTR_ROLE,ACCORDION_ROLE_TABPANEL),_defineProperty(A,ATTR_LABELLEDBY,ACCORDION_PREFIX_IDS+r+ACCORDION_BUTTON_ID+a),_defineProperty(A,"id",ACCORDION_PREFIX_IDS+r+ACCORDION_PANEL_ID+a),A)),"true"===l?(c.setAttribute(ATTR_EXPANDED,"true"),e.removeAttribute(ACCORDION_DATA_OPENED),o.setAttribute(ATTR_HIDDEN,"false")):(c.setAttribute(ATTR_EXPANDED,"false"),o.setAttribute(ATTR_HIDDEN,"true")),1===a&&c.removeAttribute("tabindex")})}),["click","keydown","focus"].forEach(function(e){document.body.addEventListener(e,function(t){if(hasClass(t.target,ACCORDION_JS_HEADER)===!0&&"focus"===e){var r=t.target,n=r.parentNode,s=[].slice.call(n.querySelectorAll("."+ACCORDION_JS_HEADER));unSelectHeaders(s),selectHeader(r)}hasClass(t.target,ACCORDION_JS_HEADER)===!0&&"click"===e&&!function(){var e=t.target,r=e.parentNode,n=findAncestor(e,"."+ACCORDION_JS),s=[].slice.call(n.querySelectorAll("."+ACCORDION_JS_HEADER)),A=n.getAttribute(ATTR_MULTISELECTABLE),a=findById(e.getAttribute(ATTR_CONTROLS)),o=e.getAttribute(ATTR_EXPANDED);"false"===o?(e.setAttribute(ATTR_EXPANDED,!0),a.removeAttribute(ATTR_HIDDEN),addClass(r,IS_OPENED_CLASS),addClass(n,IS_OPENED_CLASS)):(e.setAttribute(ATTR_EXPANDED,!1),a.setAttribute(ATTR_HIDDEN,!0),removeClass(r,IS_OPENED_CLASS),removeClass(n,IS_OPENED_CLASS)),"false"===A&&s.forEach(function(t){var r=t.parentNode,n=findById(t.getAttribute(ATTR_CONTROLS));t!==e?(t.setAttribute(ATTR_SELECTED,!1),t.setAttribute(ATTR_EXPANDED,!1),n.setAttribute(ATTR_HIDDEN,!0),removeClass(r,IS_OPENED_CLASS)):t.setAttribute(ATTR_SELECTED,!0)}),setTimeout(function(){e.focus()},0),t.preventDefault()}(),hasClass(t.target,ACCORDION_JS_HEADER)===!0&&"keydown"===e&&!function(){var e=t.target,r=e.parentNode,n=[].slice.call(r.querySelectorAll("."+ACCORDION_JS_HEADER));36===t.keyCode?(unSelectHeaders(n),selectHeader(n[0]),setTimeout(function(){n[0].focus()},0),t.preventDefault()):35===t.keyCode?(unSelectHeaders(n),selectHeader(n[n.length-1]),setTimeout(function(){n[n.length-1].focus()},0),t.preventDefault()):37!==t.keyCode&&38!==t.keyCode||t.ctrlKey?40!==t.keyCode&&39!==t.keyCode||t.ctrlKey||("true"===n[n.length-1].getAttribute(ATTR_SELECTED)?(unSelectHeaders(n),selectHeader(n[0]),setTimeout(function(){n[0].focus()},0),t.preventDefault()):(selectHeaderInList(n,"next"),t.preventDefault())):"true"===n[0].getAttribute(ATTR_SELECTED)?(unSelectHeaders(n),selectHeader(n[n.length-1]),setTimeout(function(){n[n.length-1].focus()},0),t.preventDefault()):(selectHeaderInList(n,"prev"),t.preventDefault())}();var A=searchParent(t.target,ACCORDION_JS_PANEL);""!==A&&"keydown"===e&&!function(){var e=findById(A),r=e.parentNode,n=[].slice.call(r.querySelectorAll("."+ACCORDION_JS_HEADER)),s=findById(e.getAttribute(ATTR_LABELLEDBY));38===t.keyCode&&t.ctrlKey&&(unSelectHeaders(n),selectHeader(s),setTimeout(function(){s.focus()},0),t.preventDefault()),33===t.keyCode&&t.ctrlKey&&(unSelectHeaders(n),selectHeader(s),s.focus(),t.preventDefault(),"true"===n[0].getAttribute(ATTR_SELECTED)?(unSelectHeaders(n),selectHeader(n[n.length-1]),setTimeout(function(){n[n.length-1].focus()},0)):selectHeaderInList(n,"prev")),34===t.keyCode&&t.ctrlKey&&(unSelectHeaders(n),selectHeader(s),s.focus(),t.preventDefault(),"true"===n[n.length-1].getAttribute(ATTR_SELECTED)?(unSelectHeaders(n),selectHeader(n[0]),setTimeout(function(){n[0].focus()},0)):selectHeaderInList(n,"next"))}()},!0)})};exports.init=init;